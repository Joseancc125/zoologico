name: SDKManager script CI

on:
  push:
    paths:
      - 'scripts/sdkmanager_auto.sh'
      - '.github/workflows/ci-sdkmanager.yml'
  pull_request:
    paths:
      - 'scripts/sdkmanager_auto.sh'

jobs:
  lint-shell:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install shellcheck
        run: sudo apt-get update && sudo apt-get install -y shellcheck

      - name: Shellcheck script
        run: shellcheck scripts/sdkmanager_auto.sh

      - name: Syntax check (bash -n)
        run: bash -n scripts/sdkmanager_auto.sh

      - name: Run basic dry-run (no network)
        env:
          SDK_EMAIL: test@example.com
          SDK_TOKEN_FILE: /dev/null
        run: |
          # ensure script prints usage when token missing
          set +e
          scripts/sdkmanager_auto.sh --version 5.1.2 --download-only || true
          set -e
